镜像 --> 只读
容器 --> 系统
仓库



# 创建一个新的shell
docker exec -t -i showdoc /bin/bash


# 在后台执行一个交互任务
docker exec -d daemon_dave touch /etc/new_config_file

# cp
docker cp 123.txt bb089aa:/root/


# install mac
brew install docker docker-compose docker-machine
brew cask install virtualbox

# create machine
docker-machine create --driver virtualbox default
docker-machine start default

# test docker
docker run hello-world


# pull images
docker pull nginx

# docker run
docker run -d -p 80:80 --name webserver nginx

# docker stop
# docker rm





#  基本语法
FROM nginx # 基础镜像
FROM scratch # 空镜像

# RUN
RUN apt-get update
RUN apt-get install -y gcc libc6-dev make
RUN wget -O redis.tar.gz "http://download.redis.io/releases/redis-3.2.5.tar.gz"
RUN mkdir -p /usr/src/redis
RUN tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1
RUN make -C /usr/src/redis
RUN make -C /usr/src/redis install

Dockerfile中每个指令都会建立一层镜像, RUN也不例外, 所以正确的做法是写在一起
RUN buildDeps='gcc libc6-dev make' \
    && apt-get update \
    && apt-get install -y $buildDeps \
    && wget -O redis.tar.gz "http://download.redis.io/releases/redis-3.2.5.tar.gz" \
    && mkdir -p /usr/src/redis \
    && tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1 \
    && make -C /usr/src/redis \
    && make -C /usr/src/redis install \
    && rm -rf /var/lib/apt/lists/* \ # 清理不用的文件
    && rm redis.tar.gz \
    && rm -r /usr/src/redis \
    && apt-get purge -y --auto-remove $buildDeps # 清理apt-get缓存文件



# 创建镜像
docker build -t nginx:v3 .



# 解决方案
# Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
docker-machine restart&&eval "$(docker-machine env default)"&&docker-machine env

DOCKER 会把当前context中的文件复制到docker引擎中

# COPY 错误用法
COPY ../package.json /app 或者 COPY /opt/xxxx /app
# COPY 正确用法
COPY ./package.json /app/



# docker build 用法
docker build -t nginx:v3 .
docker build https://github.com/twang2218/gitlab-ce-zh.git#
docker build http://server/context.tar.gz

